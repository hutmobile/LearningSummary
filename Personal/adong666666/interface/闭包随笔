//  Created by adong666666 on 2018/8/18. Copyright Â© 2018å¹´ adong666666. All rights reserved.
import Foundation
import Alamofire

enum MethodType {
    case get
    case post
}

class Networktools{
    class func requestData(URLString: String, type: MethodType, parameters: [String: Any]? = nil, 
    finishedCallback: @escaping (_ result: Any)->()) {
        let method = type == .get ? HTTPMethod.get : HTTPMethod.post
        
        Alamofire.request(home_url, method: method, parameters: parameters).responseJSON( completionHandler: {(response) in
            guard let result = response.result.value else{
                print(response.result.error ?? 0)
                return
            }
            finishedCallback(result)
        })
        
    }
}

æ³¨æ„åˆ°é€ƒé€¸é—­åŒ…ï¼ˆ_ result: Anyï¼‰->()æ•´ä¸ªæ˜¯ä¸€ä¸ªå‚æ•°ï¼Œç”±äºåœ¨ Alamofire.request(home_url, method: method,
parameters: parameters).responseJSONè¿™ä¸ªè¯·æ±‚ä¸­è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸æ˜¯åœ¨requestData ä¸­ç›´æ¥è°ƒç”¨ï¼Œæ•…æ­¤å¤„ä¸èƒ½ä½¿ç”¨æ™®é€šé—­åŒ…ï¼Œ
è€Œè¦åŠ å…³é”®å­—@escaping  ä½¿å…¶æˆä¸ºä¸€ä¸ªé€ƒé€¸é—­åŒ…ï¼Œå¯ä»¥åœ¨å…¶ä»–å‡½æ•°æˆ–æ–¹æ³•æˆ–è¯·æ±‚ä¸­è¿›è¡Œè°ƒç”¨ï¼Œæ³¨æ„åˆ° requestDataä¸­æ‰€è®¾ç½®çš„å‚æ•°éƒ½æœ‰è¢«ä½¿ç”¨åˆ°

URLString: String, type: MethodType, parameters: [String: Any]? = nil, 
    finishedCallback: @escaping (_ result: Any)->()
    
    å¯ä»¥ç»†ç»†åœ°ä½“ä¼š
    
    
    
{(response) in
            guard let result = response.result.value else{
                print(response.result.error ?? 0)
                return
            }
            finishedCallback(result)
        }
        
        
è¿™ä¸€æ•´ä¸ªå°±æ˜¯ä¸ªé—­åŒ…ï¼Œ in  ç›¸å½“äº ->   

response æ˜¯é—­åŒ…çš„å‚æ•°ï¼Œ ç›¸å½“äº(_ result: Any)ï¼Œ  æ‰€ä»¥responseæœ‰ä¸€ä¸ªå±æ€§: response.result,

finishedCallback(result)æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œ

 guard let result = response.result.value else{
                print(response.result.error ?? 0)
                return
            }
            finishedCallback(result)
è¿™ä¸ªå°±ç›¸å½“äºä¸€ä¸ªï¼ˆï¼‰ï¼Œå³void ,æ— è¿”å›å€¼ï¼Œå¦‚æœé‡Œé¢æœ‰å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦returnæ‰€éœ€è¦çš„è¿”å›å€¼

completionHandeler æ˜¯å¯ä»¥çœç•¥çš„ï¼Œ è¿˜å¯ä»¥å†™æˆä¸‹é¢è¿™ä¸ªæ ·å­

class Networktools{
    class func requestData(URLString: String, type: MethodType, parameters: [String: Any]? = nil, 
    finishedCallback: @escaping (_ result: Any)->()) {
        let method = type == .get ? HTTPMethod.get : HTTPMethod.post
        
        Alamofire.request(home_url, method: method, parameters: parameters).responseJSON {(response) in
            guard let result = response.result.value else{
                print(response.result.error ?? 0)
                return
            }
            finishedCallback(result)
        }
        
    }
}

 
 
 
 
 
 
 è€Œååœ¨éœ€è¦çš„åœ°æ–¹å°±èƒ½å¤Ÿè°ƒç”¨æ­¤ç±»æ–¹æ³•äº†ï¼Œæ³¨æ„åˆ°ä»–æ˜¯ä¸ªclass func ,ä»¥ä¾¿åœ¨å…¶ä»–ç±»é‡Œä¹Ÿèƒ½æ–¹ä¾¿è°ƒç”¨
 
 
 
 extension shouyeViewController{
    fileprivate func loadData(){
        Networktools.requestData(URLString: home_url, type: .get){ (result : Any) in
            print(result)
        }
    }
}

æ¯”å¦‚åœ¨shouyeViewControllerä¸­å†™ä¸€ä¸ªå‡½æ•°ï¼Œç”¨extensionçš„è¯è¦ç”¨æ–‡ä»¶ç§æœ‰ï¼Œå³åœ¨å½“å‰æ–‡ä»¶ä¸­æ‰èƒ½è®¿é—® ï¼Œfileprivate 



å¦å¤– open æ˜¯å¯ä»¥è·¨é¡¹ç›®è®¿é—®çš„ ï¼Œç±»ä¼¼äºpublic ,å½“ç„¶publicåœ¨swift 4 ä¸­ä¸å¸¸ç”¨äº†ï¼Œä¸€èˆ¬æ˜¯åœ¨æ‰©å±•çš„æ—¶å€™ç”¨ï¼Œå¦‚
public extension Double{
}
å¦‚ UIColor,UILabel,UIView......,åˆ«ä»¥ä¸ºäººå®¶æ˜¯ç”Ÿæ¥å°±æœ‰ï¼Œ äººå®¶ä¹Ÿåªæ˜¯ä¸€ä¸ªç±» open class UIColor{}è€Œå·²ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½è°ƒç”¨ç›¸åº”æ¡†æ¶å†…çš„ç±»å’Œå‡½æ•°ï¼Œ
è¿™ä¸ªå°±æ˜¯UIKitä¸­çš„è¯¸å¤šç±»ä¹‹ä¸€å•¦
å’±ä»¬åªæ˜¯å¤©ç”Ÿè¦å¼º


è€Œ private æ˜¯ç»å¯¹ç§æœ‰ï¼Œåªèƒ½åœ¨å½“å‰ç±»ä¸­ä½¿ç”¨ï¼Œextension ä¸­éƒ½ä¸èƒ½è°ƒç”¨ï¼Œæƒ³è¦è°ƒç”¨å°±åªèƒ½fileprivate

å†è€…å°±æ˜¯internal ,è¿™ä¸ªæ˜¯é»˜è®¤çš„å“ˆï¼Œæˆ‘ä»¬éƒ½ç”¨äº†è¿™ä¹ˆå¤šéäº†ï¼Œå´ä¸ä¸€å®šæ³¨æ„åˆ°å®ƒï¼Œå®ƒæ˜¯å¯ä»¥çœç•¥çš„,åœ¨é¡¹ç›®å†…ç§æœ‰
    
æœ€åä½¿ç”¨è°ƒç”¨loadData()è¿™ä¸ªå‡½æ•°ï¼Œå°±èƒ½è¯·æ±‚åˆ°æ•°æ®äº†ï¼Œè®°å¾—ç»™home_url èµ‹å€¼ â€œâ€,ä¸€ä¸ªå­—ç¬¦ä¸²é“¾æ¥ï¼Œhttps://.....



æ³¨æ„äº†ï¼Œç”±äºhttpè¯·æ±‚ä¸æ˜¯å¾ˆå®‰å…¨ï¼ŒiOSé»˜è®¤å…³é—­äº†httpè¯·æ±‚ï¼Œæ‰€ä»¥å¦‚æœè¦ç”¨httpè¯·æ±‚ï¼Œä½ éœ€è¦åœ¨info plistä¸­æ·»åŠ ä¸ªApp Transport Security Settings
ç®€ç§°atpè®¾ç½®ï¼Œå¼€å‘äººå‘˜åŸºæœ¬ä¸Šäººå°½çš†çŸ¥ï¼Œåœ¨å…¶ä¸­å†æ·»åŠ ä¸ªAllow Arbitrary Loads å°†é»˜è®¤çš„boolå€¼ä»NOæ”¹ä¸ºYES


å¯¹äº†ï¼Œä½†æ˜¯å¦‚æœä½ åˆåŠ ä¸ªAllow Arbitrary Loads in Web Content ,å¹¶ä¸”è®¾ç½®ä¸ºYESï¼Œhttpè¯·æ±‚ä¼šå¤±è´¥çš„å“¦ï¼Œè‹¹æœå°±æ˜¯è¿™ä¹ˆä¼šæŠ˜è…¾ï¼Œå¦‚æœéè¦ç”¨ä¸¤ä¸ªçš„è¯

å¯ä»¥è€ƒè™‘å¼„ä¸ªHTTPè¯ä¹¦è¯•è¯•ï¼Œæ¯•ç«Ÿä¹ŸæŠ˜è…¾äº†è¿™ä¹ˆä¹…äº†




å¯¹äº†ï¼ŒåŠ ç‚¹ä¸œè¥¿å“ˆ

   æˆ‘å¸¸ç”¨è¿™ä¸ªæ¥è§„èŒƒä»£ç ï¼Œè€Œå®é™…ä¸Šå®ƒä¹Ÿæ˜¯ä¸ªé—­åŒ…
    var btn: PowerButton = {
        let bt1 = PowerButton(type: UIButtonType.roundedRect)
        bt1.frame = CGRect(x: 0.fitScreen, y: 35.fitHeight, width: 20.fitScreen, height: 35.fitHeight)
        bt1.setBackgroundImage(UIImage(named: "è¿”å›"), for: UIControlState())
        bt1.setTitle(" ", for: UIControlState())
        bt1.setTitleColor(UIColor.white, for: UIControlState())
        bt1.addTarget(self, action: #selector(histroicalViewController.buttonTap(_:)), for: UIControlEvents.touchUpInside)
        return bt1
    }()
   
   
    ç­‰ä»·äº 
    
    var btn: PowerButton = {() in
        let bt1 = PowerButton(type: UIButtonType.roundedRect)
        bt1.frame = CGRect(x: 0.fitScreen, y: 35.fitHeight, width: 20.fitScreen, height: 35.fitHeight)
        bt1.setBackgroundImage(UIImage(named: "è¿”å›"), for: UIControlState())
        bt1.setTitle(" ", for: UIControlState())
        bt1.setTitleColor(UIColor.white, for: UIControlState())
        bt1.addTarget(self, action: #selector(histroicalViewController.buttonTap(_:)), for: UIControlEvents.touchUpInside)
        return bt1
    }(
    
    
    
    ï¼ˆï¼‰in ()    ç­‰ä»·äº  ()->()
    
     å› ä¸º()inï¼Œ () ä¸­æ²¡æœ‰å‚æ•°ï¼Œæ•…å¯çœç•¥ï¼Œ å¿…é¡»è¿ç€inçœç•¥
     
     æ‰€ä»¥è¦æœ‰æ„è¯†ï¼Œä¸Šè¿°çš„ä¸œè¥¿å®è´¨ä¸Šæ˜¯ä¸€ä¸ªé—­åŒ…


     
     
      ä»¥ä¸Šå¯¹é—­åŒ…çš„ç†è§£è¿˜æœ‰äº›è®¸é—®é¢˜ï¼Œè¿™é‡Œæˆ‘çº æ­£ä¸€ä¸‹
      ä¸‹æ–¹å°±æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œ in ä¹Ÿä¸æ˜¯ç›¸å½“äº ä»€ä¹ˆ ->,  é‚£å®Œå…¨æ˜¯è¯¯è§£
      
{ (parameters) -> return type in
    statements
}  
é—­åŒ…è¿™ä¸ªä¸œè¥¿çœŸæ˜¯ä¸ç®€å•ï¼Œç”¨å¾—å¥½ï¼ŒçœŸæ˜¯è®©åˆå­¦è€…æ€€ç–‘äººç”Ÿ

æ¯”å¦‚è¿™ä¹ˆä¸€å¥
reversedNames = names.sorted(by: >)

é‡Œé¢çš„> çš„ç¡®è®©äººæ‘¸ä¸ç€å¤´è„‘ï¼Œè€Œå®é™…ä¸Šç«Ÿç„¶æ˜¯å› ä¸ºç¼–è¯‘å™¨éå¸¸å¼ºå¤§ï¼Œå¯è°“æ˜¯ç¼–è¯‘å™¨ç•Œçš„å·¥è—¤æ–°ä¸€ï¼Œ
å®ƒèƒ½æ¨æ–­å‡ºç¨‹åºå‘˜æ‰€æƒ³è¦é£™åˆ°çš„æ„è¯†ï¼Œæ‰€ä»¥è¿™æ ·å†™å°±å¯ä»¥è¿è¡Œäº†ï¼Œä½†å®è´¨ä¸Š

reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 > s2
})
è¿™ä¸ªæ‰æ˜¯å…¶åŸèº«ï¼Œè¿™ç®€åŒ–å·¥ä½œï¼Œè¿™æ¨ç†èƒ½åŠ›ï¼Œæˆ‘çœŸæ˜¯å¤§ä¸ºæƒŠå¹ï¼Œè€Œä¸”äººå®¶æ•™ç¨‹è®²å¾—å¤´å¤´æ˜¯é“ï¼Œæˆ‘æ ¹æœ¬åé©³ä¸äº†ï¼ ğŸ˜‚ğŸ˜‚



å¯¹äºé—­åŒ…æ¨èå…ˆç”¨å†ç†è§£ï¼Œå®˜æ–¹æ•™ç¨‹éå¸¸è¯¦ç»†äº†ï¼Œæˆ‘æƒ³ã€‚  è¿™é‡Œæˆ‘æˆªå–å…¶ç²¾åçºªå¿µä¸€ä¸‹


é—­åŒ…è¡¨è¾¾å¼è¯­æ³•
é—­åŒ…è¡¨è¾¾å¼è¯­æ³•æœ‰å¦‚ä¸‹çš„ä¸€èˆ¬å½¢å¼ï¼š

{ (parameters) -> return type in
    statements
}
é—­åŒ…è¡¨è¾¾å¼å‚æ•° å¯ä»¥æ˜¯ in-out å‚æ•°ï¼Œä½†ä¸èƒ½è®¾å®šé»˜è®¤å€¼ã€‚å¦‚æœä½ å‘½åäº†å¯å˜å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å¯å˜å‚æ•°ã€‚å…ƒç»„ä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°å’Œè¿”å›å€¼ã€‚

ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¹‹å‰ backward(_:_:) å‡½æ•°å¯¹åº”çš„é—­åŒ…è¡¨è¾¾å¼ç‰ˆæœ¬çš„ä»£ç ï¼š

reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 > s2
})
éœ€è¦æ³¨æ„çš„æ˜¯å†…è”é—­åŒ…å‚æ•°å’Œè¿”å›å€¼ç±»å‹å£°æ˜ä¸ backward(_:_:) å‡½æ•°ç±»å‹å£°æ˜ç›¸åŒã€‚åœ¨è¿™ä¸¤ç§æ–¹å¼ä¸­ï¼Œéƒ½å†™æˆäº† (s1: String, s2: String) -> Boolã€‚
ç„¶è€Œåœ¨å†…è”é—­åŒ…è¡¨è¾¾å¼ä¸­ï¼Œå‡½æ•°å’Œè¿”å›å€¼ç±»å‹éƒ½å†™åœ¨å¤§æ‹¬å·å†…ï¼Œè€Œä¸æ˜¯å¤§æ‹¬å·å¤–ã€‚

é—­åŒ…çš„å‡½æ•°ä½“éƒ¨åˆ†ç”±å…³é”®å­— in å¼•å…¥ã€‚è¯¥å…³é”®å­—è¡¨ç¤ºé—­åŒ…çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹å®šä¹‰å·²ç»å®Œæˆï¼Œé—­åŒ…å‡½æ•°ä½“å³å°†å¼€å§‹ã€‚

ç”±äºè¿™ä¸ªé—­åŒ…çš„å‡½æ•°ä½“éƒ¨åˆ†å¦‚æ­¤çŸ­ï¼Œä»¥è‡³äºå¯ä»¥å°†å…¶æ”¹å†™æˆä¸€è¡Œä»£ç ï¼š

reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in return s1 > s2 } )
è¯¥ä¾‹ä¸­ sorted(by:) æ–¹æ³•çš„æ•´ä½“è°ƒç”¨ä¿æŒä¸å˜ï¼Œä¸€å¯¹åœ†æ‹¬å·ä»ç„¶åŒ…è£¹ä½äº†æ–¹æ³•çš„æ•´ä¸ªå‚æ•°ã€‚ç„¶è€Œï¼Œå‚æ•°ç°åœ¨å˜æˆäº†å†…è”é—­åŒ…ã€‚


æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹
å› ä¸ºæ’åºé—­åŒ…å‡½æ•°æ˜¯ä½œä¸º sorted(by:) æ–¹æ³•çš„å‚æ•°ä¼ å…¥çš„ï¼ŒSwift å¯ä»¥æ¨æ–­å…¶å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ã€‚sorted(by:) æ–¹æ³•è¢«ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„è°ƒç”¨ï¼Œ
å› æ­¤å…¶å‚æ•°å¿…é¡»æ˜¯ (String, String) -> Bool ç±»å‹çš„å‡½æ•°ã€‚è¿™æ„å‘³ç€ (String, String) å’Œ Bool ç±»å‹å¹¶ä¸éœ€è¦ä½œä¸ºé—­åŒ…è¡¨è¾¾å¼å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚
å› ä¸ºæ‰€æœ‰çš„ç±»å‹éƒ½å¯ä»¥è¢«æ­£ç¡®æ¨æ–­ï¼Œè¿”å›ç®­å¤´ï¼ˆ->ï¼‰å’Œå›´ç»•åœ¨å‚æ•°å‘¨å›´çš„æ‹¬å·ä¹Ÿå¯ä»¥è¢«çœç•¥ï¼š

reversedNames = names.sorted(by: { s1, s2 in return s1 > s2 } )
å®é™…ä¸Šï¼Œé€šè¿‡å†…è”é—­åŒ…è¡¨è¾¾å¼æ„é€ çš„é—­åŒ…ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œæ€»æ˜¯èƒ½å¤Ÿæ¨æ–­å‡ºé—­åŒ…çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚è¿™æ„å‘³ç€é—­åŒ…ä½œä¸ºå‡½æ•°æˆ–è€…æ–¹æ³•çš„å‚æ•°æ—¶ï¼Œ
ä½ å‡ ä¹ä¸éœ€è¦åˆ©ç”¨å®Œæ•´æ ¼å¼æ„é€ å†…è”é—­åŒ…ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä½ ä»ç„¶å¯ä»¥æ˜ç¡®å†™å‡ºæœ‰ç€å®Œæ•´æ ¼å¼çš„é—­åŒ…ã€‚å¦‚æœå®Œæ•´æ ¼å¼çš„é—­åŒ…èƒ½å¤Ÿæé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œåˆ™æˆ‘ä»¬æ›´é¼“åŠ±é‡‡ç”¨å®Œæ•´æ ¼å¼çš„é—­åŒ…ã€‚è€Œåœ¨ sorted(by:) 
æ–¹æ³•è¿™ä¸ªä¾‹å­é‡Œï¼Œæ˜¾ç„¶é—­åŒ…çš„ç›®çš„å°±æ˜¯æ’åºã€‚ç”±äºè¿™ä¸ªé—­åŒ…æ˜¯ä¸ºäº†å¤„ç†å­—ç¬¦ä¸²æ•°ç»„çš„æ’åºï¼Œå› æ­¤è¯»è€…èƒ½å¤Ÿæ¨æµ‹å‡ºè¿™ä¸ªé—­åŒ…æ˜¯ç”¨äºå­—ç¬¦ä¸²å¤„ç†çš„ã€‚


å•è¡¨è¾¾å¼é—­åŒ…éšå¼è¿”å›
å•è¡Œè¡¨è¾¾å¼é—­åŒ…å¯ä»¥é€šè¿‡çœç•¥ return å…³é”®å­—æ¥éšå¼è¿”å›å•è¡Œè¡¨è¾¾å¼çš„ç»“æœï¼Œå¦‚ä¸Šç‰ˆæœ¬çš„ä¾‹å­å¯ä»¥æ”¹å†™ä¸ºï¼š

reversedNames = names.sorted(by: { s1, s2 in s1 > s2 } )
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œsorted(by:) æ–¹æ³•çš„å‚æ•°ç±»å‹æ˜ç¡®äº†é—­åŒ…å¿…é¡»è¿”å›ä¸€ä¸ª Bool ç±»å‹å€¼ã€‚å› ä¸ºé—­åŒ…å‡½æ•°ä½“åªåŒ…å«äº†ä¸€ä¸ªå•ä¸€è¡¨è¾¾å¼ï¼ˆs1 > s2ï¼‰ï¼Œ
è¯¥è¡¨è¾¾å¼è¿”å› Bool ç±»å‹å€¼ï¼Œå› æ­¤è¿™é‡Œæ²¡æœ‰æ­§ä¹‰ï¼Œreturn å…³é”®å­—å¯ä»¥çœç•¥ã€‚


å‚æ•°åç§°ç¼©å†™
Swift è‡ªåŠ¨ä¸ºå†…è”é—­åŒ…æä¾›äº†å‚æ•°åç§°ç¼©å†™åŠŸèƒ½ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ $0ï¼Œ$1ï¼Œ$2 æ¥é¡ºåºè°ƒç”¨é—­åŒ…çš„å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚

å¦‚æœä½ åœ¨é—­åŒ…è¡¨è¾¾å¼ä¸­ä½¿ç”¨å‚æ•°åç§°ç¼©å†™ï¼Œä½ å¯ä»¥åœ¨é—­åŒ…å®šä¹‰ä¸­çœç•¥å‚æ•°åˆ—è¡¨ï¼Œå¹¶ä¸”å¯¹åº”å‚æ•°åç§°ç¼©å†™çš„ç±»å‹ä¼šé€šè¿‡å‡½æ•°ç±»å‹è¿›è¡Œæ¨æ–­ã€‚
in å…³é”®å­—ä¹ŸåŒæ ·å¯ä»¥è¢«çœç•¥ï¼Œå› ä¸ºæ­¤æ—¶é—­åŒ…è¡¨è¾¾å¼å®Œå…¨ç”±é—­åŒ…å‡½æ•°ä½“æ„æˆï¼š

reversedNames = names.sorted(by: { $0 > $1 } )
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ$0 å’Œ $1 è¡¨ç¤ºé—­åŒ…ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª String ç±»å‹çš„å‚æ•°ã€‚


è¿ç®—ç¬¦æ–¹æ³•
å®é™…ä¸Šè¿˜æœ‰ä¸€ç§æ›´ç®€çŸ­çš„æ–¹å¼æ¥ç¼–å†™ä¸Šé¢ä¾‹å­ä¸­çš„é—­åŒ…è¡¨è¾¾å¼ã€‚Swift çš„ String ç±»å‹å®šä¹‰äº†å…³äºå¤§äºå·ï¼ˆ>ï¼‰çš„å­—ç¬¦ä¸²å®ç°ï¼Œ
å…¶ä½œä¸ºä¸€ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª String ç±»å‹çš„å‚æ•°å¹¶è¿”å› Bool ç±»å‹çš„å€¼ã€‚è€Œè¿™æ­£å¥½ä¸ sorted(by:) æ–¹æ³•çš„å‚æ•°éœ€è¦çš„å‡½æ•°ç±»å‹ç›¸ç¬¦åˆã€‚
å› æ­¤ï¼Œä½ å¯ä»¥ç®€å•åœ°ä¼ é€’ä¸€ä¸ªå¤§äºå·ï¼ŒSwift å¯ä»¥è‡ªåŠ¨æ¨æ–­å‡ºä½ æƒ³ä½¿ç”¨å¤§äºå·çš„å­—ç¬¦ä¸²å‡½æ•°å®ç°ï¼š

reversedNames = names.sorted(by: >)
æ›´å¤šå…³äºè¿ç®—ç¬¦æ–¹æ³•çš„å†…å®¹è¯·æŸ¥çœ‹è¿ç®—ç¬¦æ–¹æ³•ã€‚


å°¾éšé—­åŒ…
å¦‚æœä½ éœ€è¦å°†ä¸€ä¸ªå¾ˆé•¿çš„é—­åŒ…è¡¨è¾¾å¼ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨å°¾éšé—­åŒ…æ¥å¢å¼ºå‡½æ•°çš„å¯è¯»æ€§ã€‚å°¾éšé—­åŒ…æ˜¯ä¸€ä¸ªä¹¦å†™åœ¨å‡½æ•°æ‹¬å·ä¹‹åçš„é—­åŒ…è¡¨è¾¾å¼ï¼Œ
å‡½æ•°æ”¯æŒå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°è°ƒç”¨ã€‚åœ¨ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ä¸ç”¨å†™å‡ºå®ƒçš„å‚æ•°æ ‡ç­¾ï¼š

func someFunctionThatTakesAClosure(closure: () -> Void) {
    // å‡½æ•°ä½“éƒ¨åˆ†
}

// ä»¥ä¸‹æ˜¯ä¸ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
someFunctionThatTakesAClosure(closure: {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
})

// ä»¥ä¸‹æ˜¯ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
someFunctionThatTakesAClosure() {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
}
åœ¨é—­åŒ…è¡¨è¾¾å¼è¯­æ³•ä¸€èŠ‚ä¸­ä½œä¸º sorted(by:) æ–¹æ³•å‚æ•°çš„å­—ç¬¦ä¸²æ’åºé—­åŒ…å¯ä»¥æ”¹å†™ä¸ºï¼š

reversedNames = names.sorted() { $0 > $1 }
å¦‚æœé—­åŒ…è¡¨è¾¾å¼æ˜¯å‡½æ•°æˆ–æ–¹æ³•çš„å”¯ä¸€å‚æ•°ï¼Œåˆ™å½“ä½ ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ç”šè‡³å¯ä»¥æŠŠ () çœç•¥æ‰ï¼š

reversedNames = names.sorted { $0 > $1 }
å½“é—­åŒ…éå¸¸é•¿ä»¥è‡³äºä¸èƒ½åœ¨ä¸€è¡Œä¸­è¿›è¡Œä¹¦å†™æ—¶ï¼Œå°¾éšé—­åŒ…å˜å¾—éå¸¸æœ‰ç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒSwift çš„ Array ç±»å‹æœ‰ä¸€ä¸ª map(_:) æ–¹æ³•ï¼Œ
è¿™ä¸ªæ–¹æ³•è·å–ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ä½œä¸ºå…¶å”¯ä¸€å‚æ•°ã€‚è¯¥é—­åŒ…å‡½æ•°ä¼šä¸ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ æ‰€æ˜ å°„çš„å€¼ã€‚å…·ä½“çš„æ˜ å°„æ–¹å¼å’Œè¿”å›å€¼ç±»å‹ç”±é—­åŒ…æ¥æŒ‡å®šã€‚

å½“æä¾›ç»™æ•°ç»„çš„é—­åŒ…åº”ç”¨äºæ¯ä¸ªæ•°ç»„å…ƒç´ åï¼Œmap(_:) æ–¹æ³•å°†è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«äº†ä¸åŸæ•°ç»„ä¸­çš„å…ƒç´ ä¸€ä¸€å¯¹åº”çš„æ˜ å°„åçš„å€¼ã€‚

ä¸‹ä¾‹ä»‹ç»äº†å¦‚ä½•åœ¨ map(_:) æ–¹æ³•ä¸­ä½¿ç”¨å°¾éšé—­åŒ…å°† Int ç±»å‹æ•°ç»„ [16, 58, 510] è½¬æ¢ä¸ºåŒ…å«å¯¹åº” String ç±»å‹çš„å€¼çš„æ•°ç»„
["OneSix", "FiveEight", "FiveOneZero"]ï¼š

let digitNames = [
    0: "Zero", 1: "One", 2: "Two",   3: "Three", 4: "Four",
    5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"
]
let numbers = [16, 58, 510]
å¦‚ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ•´å‹æ•°ä½å’Œå®ƒä»¬è‹±æ–‡ç‰ˆæœ¬åå­—ç›¸æ˜ å°„çš„å­—å…¸ã€‚åŒæ—¶è¿˜å®šä¹‰äº†ä¸€ä¸ªå‡†å¤‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ•°ç»„çš„æ•´å‹æ•°ç»„ã€‚

ä½ ç°åœ¨å¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ªå°¾éšé—­åŒ…ç»™ numbers æ•°ç»„çš„ map(_:) æ–¹æ³•æ¥åˆ›å»ºå¯¹åº”çš„å­—ç¬¦ä¸²ç‰ˆæœ¬æ•°ç»„ï¼š

let strings = numbers.map {
    (number) -> String in
    var number = number
    var output = ""
    repeat {
        output = digitNames[number % 10]! + output
        number /= 10
    } while number > 0
    return output
}
// strings å¸¸é‡è¢«æ¨æ–­ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°ç»„ï¼Œå³ [String]
// å…¶å€¼ä¸º ["OneSix", "FiveEight", "FiveOneZero"]
map(_:) ä¸ºæ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨äº†ä¸€æ¬¡é—­åŒ…è¡¨è¾¾å¼ã€‚ä½ ä¸éœ€è¦æŒ‡å®šé—­åŒ…çš„è¾“å…¥å‚æ•° number çš„ç±»å‹ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡è¦æ˜ å°„çš„æ•°ç»„ç±»å‹è¿›è¡Œæ¨æ–­ã€‚

åœ¨è¯¥ä¾‹ä¸­ï¼Œå±€éƒ¨å˜é‡ number çš„å€¼ç”±é—­åŒ…ä¸­çš„ number å‚æ•°è·å¾—ï¼Œå› æ­¤å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œ(é—­åŒ…æˆ–è€…å‡½æ•°çš„å‚æ•°æ€»æ˜¯å¸¸é‡)ï¼Œ
é—­åŒ…è¡¨è¾¾å¼æŒ‡å®šäº†è¿”å›ç±»å‹ä¸º Stringï¼Œä»¥è¡¨æ˜å­˜å‚¨æ˜ å°„å€¼çš„æ–°æ•°ç»„ç±»å‹ä¸º Stringã€‚

é—­åŒ…è¡¨è¾¾å¼åœ¨æ¯æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™åˆ›å»ºäº†ä¸€ä¸ªå«åš output çš„å­—ç¬¦ä¸²å¹¶è¿”å›ã€‚å…¶ä½¿ç”¨æ±‚ä½™è¿ç®—ç¬¦ï¼ˆnumber % 10ï¼‰è®¡ç®—æœ€åä¸€ä½æ•°å­—å¹¶åˆ©ç”¨ digitNames
å­—å…¸è·å–æ‰€æ˜ å°„çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªé—­åŒ…èƒ½å¤Ÿç”¨äºåˆ›å»ºä»»æ„æ­£æ•´æ•°çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚

æ³¨æ„

å­—å…¸ digitNames ä¸‹æ ‡åè·Ÿç€ä¸€ä¸ªå¹å·ï¼ˆ!ï¼‰ï¼Œå› ä¸ºå­—å…¸ä¸‹æ ‡è¿”å›ä¸€ä¸ªå¯é€‰å€¼ï¼ˆoptional valueï¼‰ï¼Œè¡¨æ˜è¯¥é”®ä¸å­˜åœ¨æ—¶ä¼šæŸ¥æ‰¾å¤±è´¥ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ
ç”±äºå¯ä»¥ç¡®å®š number % 10 æ€»æ˜¯ digitNames å­—å…¸çš„æœ‰æ•ˆä¸‹æ ‡ï¼Œå› æ­¤å¹å·å¯ä»¥ç”¨äºå¼ºåˆ¶è§£åŒ…ï¼ˆforce-unwrapï¼‰
å­˜å‚¨åœ¨ä¸‹æ ‡çš„å¯é€‰ç±»å‹çš„è¿”å›å€¼ä¸­çš„ String ç±»å‹çš„å€¼ã€‚

ä» digitNames å­—å…¸ä¸­è·å–çš„å­—ç¬¦ä¸²è¢«æ·»åŠ åˆ° output çš„å‰éƒ¨ï¼Œé€†åºå»ºç«‹äº†ä¸€ä¸ªå­—ç¬¦ä¸²ç‰ˆæœ¬çš„æ•°å­—ã€‚ï¼ˆåœ¨è¡¨è¾¾å¼ number % 10 ä¸­ï¼Œå¦‚æœ number ä¸º 16ï¼Œ
åˆ™è¿”å› 6ï¼Œ58 è¿”å› 8ï¼Œ510 è¿”å› 0ã€‚ï¼‰

number å˜é‡ä¹‹åé™¤ä»¥ 10ã€‚å› ä¸ºå…¶æ˜¯æ•´æ•°ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­æœªé™¤å°½éƒ¨åˆ†è¢«å¿½ç•¥ã€‚å› æ­¤ 16 å˜æˆäº† 1ï¼Œ58 å˜æˆäº† 5ï¼Œ510 å˜æˆäº† 51ã€‚

æ•´ä¸ªè¿‡ç¨‹é‡å¤è¿›è¡Œï¼Œç›´åˆ° number /= 10 ä¸º 0ï¼Œè¿™æ—¶é—­åŒ…ä¼šå°†å­—ç¬¦ä¸² output è¿”å›ï¼Œè€Œ map(_:) æ–¹æ³•åˆ™ä¼šå°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ˜ å°„æ•°ç»„ä¸­ã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé€šè¿‡å°¾éšé—­åŒ…è¯­æ³•ï¼Œä¼˜é›…åœ°åœ¨å‡½æ•°åå°è£…äº†é—­åŒ…çš„å…·ä½“åŠŸèƒ½ï¼Œè€Œä¸å†éœ€è¦å°†æ•´ä¸ªé—­åŒ…åŒ…è£¹åœ¨ map(_:) æ–¹æ³•çš„æ‹¬å·å†…ã€‚


å€¼æ•è·
é—­åŒ…å¯ä»¥åœ¨å…¶è¢«å®šä¹‰çš„ä¸Šä¸‹æ–‡ä¸­æ•è·å¸¸é‡æˆ–å˜é‡ã€‚å³ä½¿å®šä¹‰è¿™äº›å¸¸é‡å’Œå˜é‡çš„åŸä½œç”¨åŸŸå·²ç»ä¸å­˜åœ¨ï¼Œé—­åŒ…ä»ç„¶å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¼•ç”¨å’Œä¿®æ”¹è¿™äº›å€¼ã€‚

Swift ä¸­ï¼Œå¯ä»¥æ•è·å€¼çš„é—­åŒ…çš„æœ€ç®€å•å½¢å¼æ˜¯åµŒå¥—å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰åœ¨å…¶ä»–å‡½æ•°çš„å‡½æ•°ä½“å†…çš„å‡½æ•°ã€‚åµŒå¥—å‡½æ•°å¯ä»¥æ•è·å…¶å¤–éƒ¨å‡½æ•°æ‰€æœ‰çš„å‚æ•°ä»¥åŠå®šä¹‰çš„å¸¸é‡å’Œå˜é‡ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œè¿™æœ‰ä¸€ä¸ªå«åš makeIncrementer çš„å‡½æ•°ï¼Œå…¶åŒ…å«äº†ä¸€ä¸ªå«åš incrementer çš„åµŒå¥—å‡½æ•°ã€‚åµŒå¥—å‡½æ•° incrementer() ä»ä¸Šä¸‹æ–‡ä¸­æ•è·äº†ä¸¤ä¸ªå€¼ï¼Œ
runningTotal å’Œ amountã€‚æ•è·è¿™äº›å€¼ä¹‹åï¼ŒmakeIncrementer å°† incrementer ä½œä¸ºé—­åŒ…è¿”å›ã€‚æ¯æ¬¡è°ƒç”¨ incrementer æ—¶ï¼Œå…¶ä¼šä»¥ amount ä½œä¸ºå¢é‡å¢åŠ 
runningTotal çš„å€¼ã€‚

func makeIncrementer(forIncrement amount: Int) -> () -> Int {
    var runningTotal = 0
    func incrementer() -> Int {
        runningTotal += amount
        return runningTotal
    }
    return incrementer
}
makeIncrementer è¿”å›ç±»å‹ä¸º () -> Intã€‚è¿™æ„å‘³ç€å…¶è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œéä¸€ä¸ªç®€å•ç±»å‹çš„å€¼ã€‚è¯¥å‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨æ—¶ä¸æ¥å—å‚æ•°ï¼Œåªè¿”å›ä¸€ä¸ª Int ç±»å‹çš„å€¼ã€‚
å…³äºå‡½æ•°è¿”å›å…¶ä»–å‡½æ•°çš„å†…å®¹ï¼Œè¯·æŸ¥çœ‹å‡½æ•°ç±»å‹ä½œä¸ºè¿”å›ç±»å‹ã€‚

makeIncrementer(forIncrement:) å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªåˆå§‹å€¼ä¸º 0 çš„æ•´å‹å˜é‡ runningTotalï¼Œç”¨æ¥å­˜å‚¨å½“å‰æ€»è®¡æ•°å€¼ã€‚è¯¥å€¼ä¸º incrementer çš„è¿”å›å€¼ã€‚

makeIncrementer(forIncrement:) æœ‰ä¸€ä¸ª Int ç±»å‹çš„å‚æ•°ï¼Œå…¶å¤–éƒ¨å‚æ•°åä¸º forIncrementï¼Œå†…éƒ¨å‚æ•°åä¸º amountï¼Œè¯¥å‚æ•°è¡¨ç¤ºæ¯æ¬¡ incrementer è¢«è°ƒç”¨æ—¶
runningTotal å°†è¦å¢åŠ çš„é‡ã€‚makeIncrementer å‡½æ•°è¿˜å®šä¹‰äº†ä¸€ä¸ªåµŒå¥—å‡½æ•° incrementerï¼Œç”¨æ¥æ‰§è¡Œå®é™…çš„å¢åŠ æ“ä½œã€‚è¯¥å‡½æ•°ç®€å•åœ°ä½¿ runningTotal
å¢åŠ  amountï¼Œå¹¶å°†å…¶è¿”å›ã€‚

å¦‚æœæˆ‘ä»¬å•ç‹¬è€ƒè™‘åµŒå¥—å‡½æ•° incrementer()ï¼Œä¼šå‘ç°å®ƒæœ‰äº›ä¸åŒå¯»å¸¸ï¼š

func incrementer() -> Int {
    runningTotal += amount
    return runningTotal
}
incrementer() å‡½æ•°å¹¶æ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œä½†æ˜¯åœ¨å‡½æ•°ä½“å†…è®¿é—®äº† runningTotal å’Œ amount å˜é‡ã€‚
è¿™æ˜¯å› ä¸ºå®ƒä»å¤–å›´å‡½æ•°æ•è·äº† runningTotal å’Œ amount å˜é‡çš„å¼•ç”¨ã€‚æ•è·å¼•ç”¨ä¿è¯äº† runningTotal å’Œ amount å˜é‡åœ¨è°ƒç”¨å®Œ makeIncrementer åä¸ä¼šæ¶ˆå¤±ï¼Œ
å¹¶ä¸”ä¿è¯äº†åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œ incrementer å‡½æ•°æ—¶ï¼ŒrunningTotal ä¾æ—§å­˜åœ¨ã€‚

æ³¨æ„

ä¸ºäº†ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸ä¼šè¢«é—­åŒ…æ”¹å˜ï¼Œæˆ–è€…åœ¨é—­åŒ…åˆ›å»ºåä¸ä¼šæ”¹å˜ï¼ŒSwift å¯èƒ½ä¼šæ”¹ä¸ºæ•è·å¹¶ä¿å­˜ä¸€ä»½å¯¹å€¼çš„æ‹·è´ã€‚

Swift ä¹Ÿä¼šè´Ÿè´£è¢«æ•è·å˜é‡çš„æ‰€æœ‰å†…å­˜ç®¡ç†å·¥ä½œï¼ŒåŒ…æ‹¬é‡Šæ”¾ä¸å†éœ€è¦çš„å˜é‡ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ makeIncrementer çš„ä¾‹å­ï¼š

let incrementByTen = makeIncrementer(forIncrement: 10)
è¯¥ä¾‹å­å®šä¹‰äº†ä¸€ä¸ªå«åš incrementByTen çš„å¸¸é‡ï¼Œè¯¥å¸¸é‡æŒ‡å‘ä¸€ä¸ªæ¯æ¬¡è°ƒç”¨ä¼šå°†å…¶ runningTotal å˜é‡å¢åŠ  10 çš„ incrementer å‡½æ•°ã€‚
è°ƒç”¨è¿™ä¸ªå‡½æ•°å¤šæ¬¡å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š

incrementByTen()
// è¿”å›çš„å€¼ä¸º10
incrementByTen()
// è¿”å›çš„å€¼ä¸º20
incrementByTen()
// è¿”å›çš„å€¼ä¸º30
å¦‚æœä½ åˆ›å»ºäº†å¦ä¸€ä¸ª incrementerï¼Œå®ƒä¼šæœ‰å±äºè‡ªå·±çš„å¼•ç”¨ï¼ŒæŒ‡å‘ä¸€ä¸ªå…¨æ–°ã€ç‹¬ç«‹çš„ runningTotal å˜é‡ï¼š

let incrementBySeven = makeIncrementer(forIncrement: 7)
incrementBySeven()
// è¿”å›çš„å€¼ä¸º7
å†æ¬¡è°ƒç”¨åŸæ¥çš„ incrementByTen ä¼šç»§ç»­å¢åŠ å®ƒè‡ªå·±çš„ runningTotal å˜é‡ï¼Œè¯¥å˜é‡å’Œ incrementBySeven ä¸­æ•è·çš„å˜é‡æ²¡æœ‰ä»»ä½•è”ç³»ï¼š

incrementByTen()
// è¿”å›çš„å€¼ä¸º40
æ³¨æ„

å¦‚æœä½ å°†é—­åŒ…èµ‹å€¼ç»™ä¸€ä¸ªç±»å®ä¾‹çš„å±æ€§ï¼Œå¹¶ä¸”è¯¥é—­åŒ…é€šè¿‡è®¿é—®è¯¥å®ä¾‹æˆ–å…¶æˆå‘˜è€Œæ•è·äº†è¯¥å®ä¾‹ï¼Œä½ å°†åœ¨é—­åŒ…å’Œè¯¥å®ä¾‹é—´åˆ›å»ºä¸€ä¸ªå¾ªç¯å¼ºå¼•ç”¨ã€‚
Swift ä½¿ç”¨æ•è·åˆ—è¡¨æ¥æ‰“ç ´è¿™ç§å¾ªç¯å¼ºå¼•ç”¨ã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒé—­åŒ…å¼•èµ·çš„å¾ªç¯å¼ºå¼•ç”¨ã€‚


é—­åŒ…æ˜¯å¼•ç”¨ç±»å‹
ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒincrementBySeven å’Œ incrementByTen éƒ½æ˜¯å¸¸é‡ï¼Œä½†æ˜¯è¿™äº›å¸¸é‡æŒ‡å‘çš„é—­åŒ…ä»ç„¶å¯ä»¥å¢åŠ å…¶æ•è·çš„å˜é‡çš„å€¼ã€‚è¿™æ˜¯å› ä¸ºå‡½æ•°å’Œé—­åŒ…éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚

æ— è®ºä½ å°†å‡½æ•°æˆ–é—­åŒ…èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡è¿˜æ˜¯å˜é‡ï¼Œä½ å®é™…ä¸Šéƒ½æ˜¯å°†å¸¸é‡æˆ–å˜é‡çš„å€¼è®¾ç½®ä¸ºå¯¹åº”å‡½æ•°æˆ–é—­åŒ…çš„å¼•ç”¨ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ
æŒ‡å‘é—­åŒ…çš„å¼•ç”¨ incrementByTen æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè€Œå¹¶éé—­åŒ…å†…å®¹æœ¬èº«ã€‚

è¿™ä¹Ÿæ„å‘³ç€å¦‚æœä½ å°†é—­åŒ…èµ‹å€¼ç»™äº†ä¸¤ä¸ªä¸åŒçš„å¸¸é‡æˆ–å˜é‡ï¼Œä¸¤ä¸ªå€¼éƒ½ä¼šæŒ‡å‘åŒä¸€ä¸ªé—­åŒ…ï¼š

let alsoIncrementByTen = incrementByTen
alsoIncrementByTen()
// è¿”å›çš„å€¼ä¸º50

é€ƒé€¸é—­åŒ…
å½“ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰è¢«æ‰§è¡Œï¼Œæˆ‘ä»¬ç§°è¯¥é—­åŒ…ä»å‡½æ•°ä¸­é€ƒé€¸ã€‚å½“ä½ å®šä¹‰æ¥å—é—­åŒ…ä½œä¸ºå‚æ•°çš„å‡½æ•°æ—¶ï¼Œ
ä½ å¯ä»¥åœ¨å‚æ•°åä¹‹å‰æ ‡æ³¨ @escapingï¼Œç”¨æ¥æŒ‡æ˜è¿™ä¸ªé—­åŒ…æ˜¯å…è®¸â€œé€ƒé€¸â€å‡ºè¿™ä¸ªå‡½æ•°çš„ã€‚

ä¸€ç§èƒ½ä½¿é—­åŒ…â€œé€ƒé€¸â€å‡ºå‡½æ•°çš„æ–¹æ³•æ˜¯ï¼Œå°†è¿™ä¸ªé—­åŒ…ä¿å­˜åœ¨ä¸€ä¸ªå‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¾ˆå¤šå¯åŠ¨å¼‚æ­¥æ“ä½œçš„å‡½æ•°æ¥å—ä¸€ä¸ªé—­åŒ…å‚æ•°ä½œä¸º
completion handlerã€‚è¿™ç±»å‡½æ•°ä¼šåœ¨å¼‚æ­¥æ“ä½œå¼€å§‹ä¹‹åç«‹åˆ»è¿”å›ï¼Œä½†æ˜¯é—­åŒ…ç›´åˆ°å¼‚æ­¥æ“ä½œç»“æŸåæ‰ä¼šè¢«è°ƒç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé—­åŒ…éœ€è¦â€œé€ƒé€¸â€å‡ºå‡½æ•°ï¼Œ
å› ä¸ºé—­åŒ…éœ€è¦åœ¨å‡½æ•°è¿”å›ä¹‹åè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š

var completionHandlers: [() -> Void] = []
func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
    completionHandlers.append(completionHandler)
}
someFunctionWithEscapingClosure(_:) å‡½æ•°æ¥å—ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ï¼Œè¯¥é—­åŒ…è¢«æ·»åŠ åˆ°ä¸€ä¸ªå‡½æ•°å¤–å®šä¹‰çš„æ•°ç»„ä¸­ã€‚å¦‚æœä½ ä¸å°†è¿™ä¸ªå‚æ•°æ ‡è®°ä¸º @escapingï¼Œ
å°±ä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚

å°†ä¸€ä¸ªé—­åŒ…æ ‡è®°ä¸º @escaping æ„å‘³ç€ä½ å¿…é¡»åœ¨é—­åŒ…ä¸­æ˜¾å¼åœ°å¼•ç”¨ selfã€‚æ¯”å¦‚è¯´ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¼ é€’åˆ° someFunctionWithEscapingClosure(_:) 
ä¸­çš„é—­åŒ…æ˜¯ä¸€ä¸ªé€ƒé€¸é—­åŒ…ï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦æ˜¾å¼åœ°å¼•ç”¨ selfã€‚ç›¸å¯¹çš„ï¼Œä¼ é€’åˆ° someFunctionWithNonescapingClosure(_:) ä¸­çš„é—­åŒ…æ˜¯ä¸€ä¸ªéé€ƒé€¸é—­åŒ…ï¼Œ
è¿™æ„å‘³ç€å®ƒå¯ä»¥éšå¼å¼•ç”¨ selfã€‚

func someFunctionWithNonescapingClosure(closure: () -> Void) {
    closure()
}

class SomeClass {
    var x = 10
    func doSomething() {
        someFunctionWithEscapingClosure { self.x = 100 }
        someFunctionWithNonescapingClosure { x = 200 }
    }
}

let instance = SomeClass()
instance.doSomething()
print(instance.x)
// æ‰“å°å‡º "200"

completionHandlers.first?()
print(instance.x)
// æ‰“å°å‡º "100"

è‡ªåŠ¨é—­åŒ…
è‡ªåŠ¨é—­åŒ…æ˜¯ä¸€ç§è‡ªåŠ¨åˆ›å»ºçš„é—­åŒ…ï¼Œç”¨äºåŒ…è£…ä¼ é€’ç»™å‡½æ•°ä½œä¸ºå‚æ•°çš„è¡¨è¾¾å¼ã€‚è¿™ç§é—­åŒ…ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œå½“å®ƒè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè¿”å›è¢«åŒ…è£…åœ¨å…¶ä¸­çš„è¡¨è¾¾å¼çš„å€¼ã€‚
è¿™ç§ä¾¿åˆ©è¯­æ³•è®©ä½ èƒ½å¤Ÿçœç•¥é—­åŒ…çš„èŠ±æ‹¬å·ï¼Œç”¨ä¸€ä¸ªæ™®é€šçš„è¡¨è¾¾å¼æ¥ä»£æ›¿æ˜¾å¼çš„é—­åŒ…ã€‚

æˆ‘ä»¬ç»å¸¸ä¼šè°ƒç”¨é‡‡ç”¨è‡ªåŠ¨é—­åŒ…çš„å‡½æ•°ï¼Œä½†æ˜¯å¾ˆå°‘å»å®ç°è¿™æ ·çš„å‡½æ•°ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œassert(condition:message:file:line:) å‡½æ•°æ¥å—è‡ªåŠ¨é—­åŒ…ä½œä¸ºå®ƒçš„ 
condition å‚æ•°å’Œ message å‚æ•°ï¼›å®ƒçš„ condition å‚æ•°ä»…ä¼šåœ¨ debug æ¨¡å¼ä¸‹è¢«æ±‚å€¼ï¼Œå®ƒçš„ message å‚æ•°ä»…å½“ condition å‚æ•°ä¸º false æ—¶è¢«è®¡ç®—æ±‚å€¼ã€‚

è‡ªåŠ¨é—­åŒ…è®©ä½ èƒ½å¤Ÿå»¶è¿Ÿæ±‚å€¼ï¼Œå› ä¸ºç›´åˆ°ä½ è°ƒç”¨è¿™ä¸ªé—­åŒ…ï¼Œä»£ç æ®µæ‰ä¼šè¢«æ‰§è¡Œã€‚å»¶è¿Ÿæ±‚å€¼å¯¹äºé‚£äº›æœ‰å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰å’Œé«˜è®¡ç®—æˆæœ¬çš„ä»£ç æ¥è¯´æ˜¯å¾ˆæœ‰ç›Šå¤„çš„ï¼Œ
å› ä¸ºå®ƒä½¿å¾—ä½ èƒ½æ§åˆ¶ä»£ç çš„æ‰§è¡Œæ—¶æœºã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†é—­åŒ…å¦‚ä½•å»¶æ—¶æ±‚å€¼ã€‚

var customersInLine = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]
print(customersInLine.count)
// æ‰“å°å‡º "5"

let customerProvider = { customersInLine.remove(at: 0) }
print(customersInLine.count)
// æ‰“å°å‡º "5"

print("Now serving \(customerProvider())!")
// Prints "Now serving Chris!"
print(customersInLine.count)
// æ‰“å°å‡º "4"
å°½ç®¡åœ¨é—­åŒ…çš„ä»£ç ä¸­ï¼ŒcustomersInLine çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«ç§»é™¤äº†ï¼Œä¸è¿‡åœ¨é—­åŒ…è¢«è°ƒç”¨ä¹‹å‰ï¼Œè¿™ä¸ªå…ƒç´ æ˜¯ä¸ä¼šè¢«ç§»é™¤çš„ã€‚å¦‚æœè¿™ä¸ªé—­åŒ…æ°¸è¿œä¸è¢«è°ƒç”¨ï¼Œ
é‚£ä¹ˆåœ¨é—­åŒ…é‡Œé¢çš„è¡¨è¾¾å¼å°†æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼Œé‚£æ„å‘³ç€åˆ—è¡¨ä¸­çš„å…ƒç´ æ°¸è¿œä¸ä¼šè¢«ç§»é™¤ã€‚è¯·æ³¨æ„ï¼ŒcustomerProvider çš„ç±»å‹ä¸æ˜¯ Stringï¼Œè€Œæ˜¯ () -> Stringï¼Œ
ä¸€ä¸ªæ²¡æœ‰å‚æ•°ä¸”è¿”å›å€¼ä¸º String çš„å‡½æ•°ã€‚

å°†é—­åŒ…ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä½ èƒ½è·å¾—åŒæ ·çš„å»¶æ—¶æ±‚å€¼è¡Œä¸ºã€‚

// customersInLine is ["Alex", "Ewa", "Barry", "Daniella"]
func serve(customer customerProvider: () -> String) {
    print("Now serving \(customerProvider())!")
}
serve(customer: { customersInLine.remove(at: 0) } )
// æ‰“å°å‡º "Now serving Alex!"
ä¸Šé¢çš„ serve(customer:) å‡½æ•°æ¥å—ä¸€ä¸ªè¿”å›é¡¾å®¢åå­—çš„æ˜¾å¼çš„é—­åŒ…ã€‚ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬çš„ serve(customer:) å®Œæˆäº†ç›¸åŒçš„æ“ä½œï¼Œä¸è¿‡å®ƒå¹¶æ²¡æœ‰æ¥å—ä¸€ä¸ªæ˜¾å¼çš„é—­åŒ…ï¼Œ
è€Œæ˜¯é€šè¿‡å°†å‚æ•°æ ‡è®°ä¸º @autoclosure æ¥æ¥æ”¶ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…ã€‚ç°åœ¨ä½ å¯ä»¥å°†è¯¥å‡½æ•°å½“ä½œæ¥å— String ç±»å‹å‚æ•°ï¼ˆè€Œéé—­åŒ…ï¼‰çš„å‡½æ•°æ¥è°ƒç”¨ã€‚customerProvider 
å‚æ•°å°†è‡ªåŠ¨è½¬åŒ–ä¸ºä¸€ä¸ªé—­åŒ…ï¼Œå› ä¸ºè¯¥å‚æ•°è¢«æ ‡è®°äº† @autoclosure ç‰¹æ€§ã€‚

// customersInLine is ["Ewa", "Barry", "Daniella"]
func serve(customer customerProvider: @autoclosure () -> String) {
    print("Now serving \(customerProvider())!")
}
serve(customer: customersInLine.remove(at: 0))
// æ‰“å° "Now serving Ewa!"
æ³¨æ„

è¿‡åº¦ä½¿ç”¨ autoclosures ä¼šè®©ä½ çš„ä»£ç å˜å¾—éš¾ä»¥ç†è§£ã€‚ä¸Šä¸‹æ–‡å’Œå‡½æ•°ååº”è¯¥èƒ½å¤Ÿæ¸…æ™°åœ°è¡¨æ˜æ±‚å€¼æ˜¯è¢«å»¶è¿Ÿæ‰§è¡Œçš„ã€‚

å¦‚æœä½ æƒ³è®©ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…å¯ä»¥â€œé€ƒé€¸â€ï¼Œåˆ™åº”è¯¥åŒæ—¶ä½¿ç”¨ @autoclosure å’Œ @escaping å±æ€§ã€‚@escaping å±æ€§çš„è®²è§£è§ä¸Šé¢çš„é€ƒé€¸é—­åŒ…ã€‚

// customersInLine i= ["Barry", "Daniella"]
var customerProviders: [() -> String] = []
func collectCustomerProviders(_ customerProvider: @autoclosure @escaping () -> String) {
    customerProviders.append(customerProvider)
}
collectCustomerProviders(customersInLine.remove(at: 0))
collectCustomerProviders(customersInLine.remove(at: 0))

print("Collected \(customerProviders.count) closures.")
// æ‰“å° "Collected 2 closures."
for customerProvider in customerProviders {
    print("Now serving \(customerProvider())!")
}
// æ‰“å° "Now serving Barry!"
// æ‰“å° "Now serving Daniella!"
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒcollectCustomerProviders(_:) å‡½æ•°å¹¶æ²¡æœ‰è°ƒç”¨ä¼ å…¥çš„ customerProvider é—­åŒ…ï¼Œè€Œæ˜¯å°†é—­åŒ…è¿½åŠ åˆ°äº† customerProviders æ•°ç»„ä¸­ã€‚
è¿™ä¸ªæ•°ç»„å®šä¹‰åœ¨å‡½æ•°ä½œç”¨åŸŸèŒƒå›´å¤–ï¼Œè¿™æ„å‘³ç€æ•°ç»„å†…çš„é—­åŒ…èƒ½å¤Ÿåœ¨å‡½æ•°è¿”å›ä¹‹åè¢«è°ƒç”¨ã€‚å› æ­¤ï¼ŒcustomerProvider å‚æ•°å¿…é¡»å…è®¸â€œé€ƒé€¸â€å‡ºå‡½æ•°ä½œç”¨åŸŸã€‚









